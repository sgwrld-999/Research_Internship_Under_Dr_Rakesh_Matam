2025-09-11 19:58:05,158 - __main__ - INFO - Training session started at 2025-09-11 19:58:05
2025-09-11 19:58:05,158 - __main__ - INFO - Session logs will be saved to: training_20250911_195805.log
2025-09-11 19:58:05,162 - __main__ - INFO - Configuration loaded successfully
2025-09-11 19:58:05,162 - __main__ - INFO - Model configuration:
LSTM Model Configuration Summary:
================================
Architecture:
  - Input: 64 time steps × 14 features
  - 2x LSTM layers (16 units each)
  - Output: 5 classes
  - Estimated parameters: ~4,181

Training Setup:
  - Learning rate: 0.001
  - Batch size: 16
  - Max epochs: 15
  - Dropout: 0.3
  - Validation split: 0.2
  - Early stopping patience: 2

Monitoring:
  - Metrics: accuracy, val_loss, precision, recall, f1_score
  - Model save path: models/saved_Models/experiment1.keras
2025-09-11 19:58:05,162 - __main__ - INFO - Loading data from /fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Project_3/dataset/combined_dataset_short_balanced_encoded_normalised.csv
2025-09-11 19:58:09,477 - __main__ - INFO - Data loaded successfully: (500000, 15)
2025-09-11 19:58:09,477 - __main__ - INFO - Features: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
2025-09-11 19:58:09,478 - __main__ - INFO - Target: label_stage_encoded
2025-09-11 19:58:09,478 - __main__ - INFO - Preparing preprocessed data for LSTM training...
2025-09-11 19:58:23,640 - __main__ - INFO - Feature matrix shape: (500000, 14)
2025-09-11 19:58:23,641 - __main__ - INFO - Target vector shape: (500000,)
2025-09-11 20:01:35,464 - __main__ - INFO - Created 499937 sequences of length 64
2025-09-11 20:01:35,464 - __main__ - INFO - Sequence shape: (499937, 64, 14)
2025-09-11 20:01:35,464 - __main__ - INFO - Target shape: (499937,)
2025-09-11 20:01:35,464 - __main__ - INFO - Preprocessed data preparation completed successfully
2025-09-11 20:01:35,464 - __main__ - INFO - Final sequence shape: (499937, 64, 14)
2025-09-11 20:01:35,464 - __main__ - INFO - Final target shape: (499937,)
2025-09-11 20:01:35,468 - __main__ - INFO - Class distribution: [100000  99937 100000 100000 100000]
2025-09-11 20:01:35,495 - __main__ - INFO - Random seeds set to 42 for reproducibility
2025-09-11 20:01:35,631 - __main__ - INFO - No GPUs detected - using CPU only
2025-09-11 20:01:35,741 - __main__ - INFO - TensorFlow configured for CPU usage. Test tensor device: /job:localhost/replica:0/task:0/device:CPU:0
2025-09-11 20:01:35,741 - __main__ - INFO - Starting LSTM model training...
2025-09-11 20:04:20,680 - __main__ - INFO - Training samples: 399949
2025-09-11 20:04:20,680 - __main__ - INFO - Validation samples: 99988
2025-09-11 20:04:20,984 - __main__ - INFO - Model built successfully
2025-09-11 20:04:20,991 - __main__ - INFO - Model: "LSTM_Classifier"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ lstm_layer_1 (LSTM)                  │ (None, 64, 16)              │           1,984 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 64, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ layer_norm_1 (LayerNormalization)    │ (None, 64, 16)              │              32 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_layer_2 (LSTM)                  │ (None, 16)                  │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 16)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ layer_norm_2 (LayerNormalization)    │ (None, 16)                  │              32 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ classification_output (Dense)        │ (None, 5)                   │              85 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 4,245 (16.58 KB)
 Trainable params: 4,245 (16.58 KB)
 Non-trainable params: 0 (0.00 B)
2025-09-11 20:04:20,992 - __main__ - INFO - Beginning training process...
Epoch 1/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 67ms/step - accuracy: 0.9440 - loss: 0.1505    
Epoch 1: val_loss improved from None to 0.07100, saving model to models/saved_Models/experiment1.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1823s 73ms/step - accuracy: 0.9616 - loss: 0.1034 - val_accuracy: 0.9730 - val_loss: 0.0710 - learning_rate: 0.0010
Epoch 2/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.9721 - loss: 0.0758      
Epoch 2: val_loss improved from 0.07100 to 0.06307, saving model to models/saved_Models/experiment1.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1324s 53ms/step - accuracy: 0.9731 - loss: 0.0734 - val_accuracy: 0.9767 - val_loss: 0.0631 - learning_rate: 0.0010
Epoch 3/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 50ms/step - accuracy: 0.9749 - loss: 0.0683    
Epoch 3: val_loss did not improve from 0.06307
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1319s 53ms/step - accuracy: 0.9747 - loss: 0.0682 - val_accuracy: 0.9755 - val_loss: 0.0656 - learning_rate: 0.0010
Epoch 4/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 58ms/step - accuracy: 0.9752 - loss: 0.0660      
Epoch 4: val_loss did not improve from 0.06307
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1528s 61ms/step - accuracy: 0.9750 - loss: 0.0665 - val_accuracy: 0.9758 - val_loss: 0.0681 - learning_rate: 0.0010
Epoch 4: early stopping
Restoring model weights from the end of the best epoch: 2.
2025-09-11 20:04:20,992 - __main__ - INFO - Beginning training process...
2025-09-11 21:46:12,371 - __main__ - INFO - Training completed successfully
2025-09-11 21:46:12,390 - __main__ - INFO - final_train_loss: 0.0665
2025-09-11 21:46:12,390 - __main__ - INFO - final_val_loss: 0.0681
2025-09-11 21:46:12,390 - __main__ - INFO - best_val_loss: 0.0631
2025-09-11 21:46:12,390 - __main__ - INFO - total_epochs: 4.0000
2025-09-11 21:46:12,390 - __main__ - INFO - final_train_accuracy: 0.9750
2025-09-11 21:46:12,390 - __main__ - INFO - final_val_accuracy: 0.9758
2025-09-11 21:46:12,390 - __main__ - INFO - best_val_accuracy: 0.9767
2025-09-11 21:46:12,391 - __main__ - INFO - Training session completed at 2025-09-11 21:46:12
2025-09-11 21:46:12,391 - __main__ - INFO - Timestamped log saved as: training_20250911_195805.log
2025-09-11 21:46:12,391 - __main__ - INFO - CSV metrics saved as: training_metrics_20250911_195805.csv
2025-09-11 21:46:12,883 - __main__ - INFO - Final model saved to: models/saved_Models/experiment1_final.keras
2025-09-11 21:46:12,891 - __main__ - INFO - Training pipeline completed successfully!
