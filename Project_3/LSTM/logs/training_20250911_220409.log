2025-09-11 22:04:09,081 - __main__ - INFO - Training session started at 2025-09-11 22:04:09
2025-09-11 22:04:09,081 - __main__ - INFO - Session logs will be saved to: training_20250911_220409.log
2025-09-11 22:04:09,084 - __main__ - INFO - Configuration loaded successfully
2025-09-11 22:04:09,084 - __main__ - INFO - Model configuration:
LSTM Model Configuration Summary:
================================
Architecture:
  - Input: 64 time steps × 14 features
  - 2x LSTM layers (16 units each)
  - Output: 5 classes
  - Estimated parameters: ~4,181

Training Setup:
  - Learning rate: 0.001
  - Batch size: 16
  - Max epochs: 15
  - Dropout: 0.2
  - Validation split: 0.2
  - Early stopping patience: 4

Monitoring:
  - Metrics: accuracy, val_loss, precision, recall, f1_score
  - Model save path: models/saved_Models/experiment2.keras
2025-09-11 22:04:09,084 - __main__ - INFO - Loading data from /fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Project_3/dataset/combined_dataset_short_balanced_encoded_normalised.csv
2025-09-11 22:04:13,933 - __main__ - INFO - Data loaded successfully: (500000, 15)
2025-09-11 22:04:13,934 - __main__ - INFO - Features: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
2025-09-11 22:04:13,934 - __main__ - INFO - Target: label_stage_encoded
2025-09-11 22:04:13,934 - __main__ - INFO - Preparing preprocessed data for LSTM training...
2025-09-11 22:04:18,225 - __main__ - INFO - Feature matrix shape: (500000, 14)
2025-09-11 22:04:18,226 - __main__ - INFO - Target vector shape: (500000,)
2025-09-11 22:05:55,674 - __main__ - INFO - Created 499937 sequences of length 64
2025-09-11 22:05:55,674 - __main__ - INFO - Sequence shape: (499937, 64, 14)
2025-09-11 22:05:55,674 - __main__ - INFO - Target shape: (499937,)
2025-09-11 22:05:55,675 - __main__ - INFO - Preprocessed data preparation completed successfully
2025-09-11 22:05:55,675 - __main__ - INFO - Final sequence shape: (499937, 64, 14)
2025-09-11 22:05:55,675 - __main__ - INFO - Final target shape: (499937,)
2025-09-11 22:05:55,678 - __main__ - INFO - Class distribution: [100000  99937 100000 100000 100000]
2025-09-11 22:05:55,681 - __main__ - INFO - Random seeds set to 42 for reproducibility
2025-09-11 22:05:55,782 - __main__ - INFO - No GPUs detected - using CPU only
2025-09-11 22:05:55,793 - __main__ - INFO - TensorFlow configured for CPU usage. Test tensor device: /job:localhost/replica:0/task:0/device:CPU:0
2025-09-11 22:05:55,793 - __main__ - INFO - Starting LSTM model training...
2025-09-11 22:07:16,093 - __main__ - INFO - Training samples: 399949
2025-09-11 22:07:16,094 - __main__ - INFO - Validation samples: 99988
2025-09-11 22:07:16,439 - __main__ - INFO - Model built successfully
2025-09-11 22:07:16,458 - __main__ - INFO - Model: "LSTM_Classifier"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ lstm_layer_1 (LSTM)                  │ (None, 64, 16)              │           1,984 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 64, 16)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ layer_norm_1 (LayerNormalization)    │ (None, 64, 16)              │              32 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lstm_layer_2 (LSTM)                  │ (None, 16)                  │           2,112 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 16)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ layer_norm_2 (LayerNormalization)    │ (None, 16)                  │              32 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ classification_output (Dense)        │ (None, 5)                   │              85 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 4,245 (16.58 KB)
 Trainable params: 4,245 (16.58 KB)
 Non-trainable params: 0 (0.00 B)

2025-09-11 22:07:16,470 - __main__ - INFO - Beginning training process...
Epoch 1/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 43ms/step - accuracy: 0.9470 - loss: 0.1425    
Epoch 1: val_loss improved from None to 0.06786, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1157s 46ms/step - accuracy: 0.9638 - loss: 0.0966 - val_accuracy: 0.9741 - val_loss: 0.0679 - learning_rate: 0.0010
Epoch 2/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 36ms/step - accuracy: 0.9724 - loss: 0.0725   
Epoch 2: val_loss improved from 0.06786 to 0.06376, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 959s 38ms/step - accuracy: 0.9729 - loss: 0.0710 - val_accuracy: 0.9764 - val_loss: 0.0638 - learning_rate: 0.0010
Epoch 3/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 39ms/step - accuracy: 0.9749 - loss: 0.0667   
Epoch 3: val_loss improved from 0.06376 to 0.06186, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1028s 41ms/step - accuracy: 0.9749 - loss: 0.0660 - val_accuracy: 0.9763 - val_loss: 0.0619 - learning_rate: 0.0010
Epoch 4/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 43ms/step - accuracy: 0.9753 - loss: 0.0638    
Epoch 4: val_loss improved from 0.06186 to 0.05917, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1147s 46ms/step - accuracy: 0.9752 - loss: 0.0639 - val_accuracy: 0.9780 - val_loss: 0.0592 - learning_rate: 0.0010
Epoch 5/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 41ms/step - accuracy: 0.9760 - loss: 0.0622    
Epoch 5: val_loss improved from 0.05917 to 0.05840, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1087s 43ms/step - accuracy: 0.9758 - loss: 0.0625 - val_accuracy: 0.9772 - val_loss: 0.0584 - learning_rate: 0.0010
Epoch 6/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 44ms/step - accuracy: 0.9763 - loss: 0.0606  ^[[D
Epoch 6: val_loss improved from 0.05840 to 0.05747, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1175s 47ms/step - accuracy: 0.9762 - loss: 0.0612 - val_accuracy: 0.9786 - val_loss: 0.0575 - learning_rate: 0.0010
Epoch 7/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 44ms/step - accuracy: 0.9767 - loss: 0.0606    
Epoch 7: val_loss did not improve from 0.05747
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 1153s 46ms/step - accuracy: 0.9764 - loss: 0.0610 - val_accuracy: 0.9783 - val_loss: 0.0582 - learning_rate: 0.0010
Epoch 8/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 36ms/step - accuracy: 0.9765 - loss: 0.0608   
Epoch 8: val_loss did not improve from 0.05747
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 953s 38ms/step - accuracy: 0.9766 - loss: 0.0607 - val_accuracy: 0.9769 - val_loss: 0.0582 - learning_rate: 0.0010
Epoch 9/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step - accuracy: 0.9772 - loss: 0.0593    
Epoch 9: val_loss improved from 0.05747 to 0.05664, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 944s 38ms/step - accuracy: 0.9770 - loss: 0.0598 - val_accuracy: 0.9775 - val_loss: 0.0566 - learning_rate: 0.0010
Epoch 10/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 33ms/step - accuracy: 0.9770 - loss: 0.0593   
Epoch 10: val_loss did not improve from 0.05664
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 892s 36ms/step - accuracy: 0.9770 - loss: 0.0597 - val_accuracy: 0.9754 - val_loss: 0.0574 - learning_rate: 0.0010
Epoch 11/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.9773 - loss: 0.0595      
Epoch 11: val_loss did not improve from 0.05664
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 910s 36ms/step - accuracy: 0.9770 - loss: 0.0599 - val_accuracy: 0.9750 - val_loss: 0.0569 - learning_rate: 0.0010
Epoch 12/15
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.9773 - loss: 0.0591   
Epoch 12: val_loss did not improve from 0.05664
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 897s 36ms/step - accuracy: 0.9770 - loss: 0.0593 - val_accuracy: 0.9761 - val_loss: 0.0583 - learning_rate: 0.0010
Epoch 13/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.9772 - loss: 0.0601   
Epoch 13: val_loss improved from 0.05664 to 0.05555, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 909s 36ms/step - accuracy: 0.9773 - loss: 0.0595 - val_accuracy: 0.9789 - val_loss: 0.0555 - learning_rate: 0.0010
Epoch 14/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.9783 - loss: 0.0577   
Epoch 14: val_loss improved from 0.05555 to 0.05545, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 907s 36ms/step - accuracy: 0.9780 - loss: 0.0581 - val_accuracy: 0.9791 - val_loss: 0.0554 - learning_rate: 0.0010
Epoch 15/15
24996/24997 ━━━━━━━━━━━━━━━━━━━━ 0s 34ms/step - accuracy: 0.9782 - loss: 0.0579    
Epoch 15: val_loss improved from 0.05545 to 0.05478, saving model to models/saved_Models/experiment2.keras
24997/24997 ━━━━━━━━━━━━━━━━━━━━ 903s 36ms/step - accuracy: 0.9780 - loss: 0.0582 - val_accuracy: 0.9792 - val_loss: 0.0548 - learning_rate: 0.0010
Restoring model weights from the end of the best epoch: 15.
2025-09-12 02:18:47,553 - __main__ - INFO - Training completed successfully
2025-09-12 02:18:47,554 - __main__ - INFO - final_train_loss: 0.0582
2025-09-12 02:18:47,555 - __main__ - INFO - final_val_loss: 0.0548
2025-09-12 02:18:47,555 - __main__ - INFO - best_val_loss: 0.0548
2025-09-12 02:18:47,555 - __main__ - INFO - total_epochs: 15.0000
2025-09-12 02:18:47,555 - __main__ - INFO - final_train_accuracy: 0.9780
2025-09-12 02:18:47,555 - __main__ - INFO - final_val_accuracy: 0.9792
2025-09-12 02:18:47,555 - __main__ - INFO - best_val_accuracy: 0.9792
2025-09-12 02:18:47,555 - __main__ - INFO - Training session completed at 2025-09-12 02:18:47
2025-09-12 02:18:47,555 - __main__ - INFO - Timestamped log saved as: training_20250911_220409.log
2025-09-12 02:18:47,555 - __main__ - INFO - CSV metrics saved as: training_metrics_20250911_220409.csv
2025-09-12 02:18:47,791 - __main__ - INFO - Final model saved to: models/saved_Models/experiment2_final.keras
2025-09-12 02:18:47,791 - __main__ - INFO - Training pipeline completed successfully!
