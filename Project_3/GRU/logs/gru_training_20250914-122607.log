2025-09-14 12:26:07,371 - __main__ - INFO - Training session started at 2025-09-14 12:26:07
2025-09-14 12:26:07,371 - __main__ - INFO - Session logs will be saved to: gru_training_20250914-122607.log
2025-09-14 12:26:07,373 - __main__ - INFO - Configuration loaded successfully
2025-09-14 12:26:07,373 - __main__ - INFO - Model configuration:
GRU Model Configuration Summary:
================================
Architecture:
  - Input: 128 time steps × 14 features
  - 4x Bidirectional GRU layers (32 units each)
  - Output: 5 classes
  - Estimated parameters: ~86,853

Training Setup:
  - Learning rate: 0.001
  - Batch size: 64
  - Max epochs: 15
  - Dropout: 0.3
  - Validation split: 0.2
  - Early stopping patience: 2

Monitoring:
  - Metrics: accuracy, precision, recall, f1_score
  - Model save path: /fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Project_3/GRU/models/saved_Models/gru_experiment2.keras
2025-09-14 12:26:07,374 - __main__ - INFO - Loading data from /fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/dataset/combined_dataset_short_balanced_encoded_normalised.csv
2025-09-14 12:26:08,223 - __main__ - INFO - Data loaded successfully: (500000, 15)
2025-09-14 12:26:08,223 - __main__ - INFO - Features: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
2025-09-14 12:26:08,224 - __main__ - INFO - Target: label_stage_encoded
2025-09-14 12:26:08,224 - __main__ - INFO - Preparing preprocessed data for GRU training...
2025-09-14 12:26:08,262 - __main__ - INFO - Feature matrix shape: (500000, 14)
2025-09-14 12:26:08,262 - __main__ - INFO - Target vector shape: (500000,)
2025-09-14 12:26:08,263 - __main__ - INFO - Creating sequences with optimized vectorization...
2025-09-14 12:26:08,454 - __main__ - INFO - Processed 50000/499873 sequences (10.0%)
2025-09-14 12:26:08,654 - __main__ - INFO - Processed 100000/499873 sequences (20.0%)
2025-09-14 12:26:08,842 - __main__ - INFO - Processed 150000/499873 sequences (30.0%)
2025-09-14 12:26:09,027 - __main__ - INFO - Processed 200000/499873 sequences (40.0%)
2025-09-14 12:26:09,214 - __main__ - INFO - Processed 250000/499873 sequences (50.0%)
2025-09-14 12:26:09,403 - __main__ - INFO - Processed 300000/499873 sequences (60.0%)
2025-09-14 12:26:09,594 - __main__ - INFO - Processed 350000/499873 sequences (70.0%)
2025-09-14 12:26:09,778 - __main__ - INFO - Processed 400000/499873 sequences (80.0%)
2025-09-14 12:26:09,963 - __main__ - INFO - Processed 450000/499873 sequences (90.0%)
2025-09-14 12:26:10,154 - __main__ - INFO - Created 499873 sequences of length 128
2025-09-14 12:26:10,154 - __main__ - INFO - Sequence shape: (499873, 128, 14)
2025-09-14 12:26:10,154 - __main__ - INFO - Target shape: (499873,)
2025-09-14 12:26:10,154 - __main__ - INFO - Preprocessed data preparation completed successfully
2025-09-14 12:26:10,154 - __main__ - INFO - Final sequence shape: (499873, 128, 14)
2025-09-14 12:26:10,154 - __main__ - INFO - Final target shape: (499873,)
2025-09-14 12:26:10,157 - __main__ - INFO - Class distribution: [100000  99873 100000 100000 100000]
2025-09-14 12:26:10,160 - __main__ - INFO - === CPU-ONLY MODE ENABLED ===
2025-09-14 12:26:10,160 - __main__ - INFO - System Info: 64 CPU cores, 373.3GB available RAM
2025-09-14 12:26:10,160 - __main__ - INFO - TensorFlow configured for CPU with 64 cores - READY FOR TRAINING!
2025-09-14 12:26:10,160 - __main__ - INFO - Random seeds set to 42 for reproducibility
2025-09-14 12:26:10,161 - __main__ - INFO - === CPU-ONLY MODE ENABLED ===
2025-09-14 12:26:10,161 - __main__ - INFO - System Info: 64 CPU cores, 373.3GB available RAM
2025-09-14 12:26:10,161 - __main__ - INFO - TensorFlow configured for CPU with 64 cores - READY FOR TRAINING!
2025-09-14 12:26:10,161 - __main__ - INFO - Starting GRU model training...
2025-09-14 12:26:10,161 - __main__ - INFO - Optimizing data types for performance...
2025-09-14 12:26:10,161 - __main__ - INFO - Splitting data into training and validation sets...
2025-09-14 12:26:11,983 - __main__ - INFO - Training samples: 399,898
2025-09-14 12:26:11,983 - __main__ - INFO - Validation samples: 99,975
2025-09-14 12:26:11,983 - __main__ - INFO - Building model architecture...
2025-09-14 12:26:12,333 - tensorflow - INFO - precision metric will be calculated manually during evaluation
2025-09-14 12:26:12,333 - tensorflow - INFO - recall metric will be calculated manually during evaluation
2025-09-14 12:26:12,333 - tensorflow - INFO - f1_score metric will be calculated manually during evaluation
2025-09-14 12:26:12,343 - __main__ - INFO - Model built successfully in 0.36 seconds
2025-09-14 12:26:12,362 - __main__ - INFO - Model: "GRU_Model"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃ Layer (type)                  ┃ Output Shape          ┃      Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ bidirectional_gru_1           │ (None, 128, 64)       │        9,216 │
│ (Bidirectional)               │                       │              │
├───────────────────────────────┼───────────────────────┼──────────────┤
│ dropout_1 (Dropout)           │ (None, 128, 64)       │            0 │
├───────────────────────────────┼───────────────────────┼──────────────┤
│ bidirectional_gru_2           │ (None, 128, 64)       │       18,816 │
│ (Bidirectional)               │                       │              │
├───────────────────────────────┼───────────────────────┼──────────────┤
│ dropout_2 (Dropout)           │ (None, 128, 64)       │            0 │
├───────────────────────────────┼───────────────────────┼──────────────┤
│ bidirectional_gru_3           │ (None, 128, 64)       │       18,816 │
│ (Bidirectional)               │                       │              │
├───────────────────────────────┼───────────────────────┼──────────────┤
│ dropout_3 (Dropout)           │ (None, 128, 64)       │            0 │
├───────────────────────────────┼───────────────────────┼──────────────┤
│ bidirectional_gru_4           │ (None, 64)            │       18,816 │
│ (Bidirectional)               │                       │              │
├───────────────────────────────┼───────────────────────┼──────────────┤
│ dropout_4 (Dropout)           │ (None, 64)            │            0 │
├───────────────────────────────┼───────────────────────┼──────────────┤
│ output_layer (Dense)          │ (None, 5)             │          325 │
└───────────────────────────────┴───────────────────────┴──────────────┘
 Total params: 65,989 (257.77 KB)
 Trainable params: 65,989 (257.77 KB)
 Non-trainable params: 0 (0.00 B)

2025-09-14 12:26:12,362 - __main__ - INFO - Setting up training callbacks...
2025-09-14 12:26:12,363 - __main__ - INFO - === STARTING TRAINING PROCESS ===
2025-09-14 12:26:12,363 - __main__ - INFO - Device: CPU
2025-09-14 12:26:12,364 - __main__ - INFO - Batch size: 64
2025-09-14 12:26:12,364 - __main__ - INFO - Total batches per epoch: 6248
2025-09-14 12:26:12,364 - __main__ - ERROR - Training pipeline failed: TensorFlowTrainer.fit() got an unexpected keyword argument 'use_multiprocessing'
2025-09-14 12:26:12,364 - __main__ - ERROR - Full traceback:
Traceback (most recent call last):
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 910, in main
    model, history = trainer.train(X, y)
                     ~~~~~~~~~~~~~^^^^^^
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 754, in train
    self.history = self.model.fit(
                   ~~~~~~~~~~~~~~^
        X_train, y_train,
        ^^^^^^^^^^^^^^^^^
    ...<7 lines>...
        workers=4 if not self.using_gpu else 1  # More workers for CPU
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/utils/traceback_utils.py", line 119, in error_handler
    filtered_tb = _process_traceback_frames(e.__traceback__)
TypeError: TensorFlowTrainer.fit() got an unexpected keyword argument 'use_multiprocessing'
