2025-09-14 10:27:28,019 - __main__ - INFO - Training session started at 2025-09-14 10:27:28
2025-09-14 10:27:28,019 - __main__ - INFO - Session logs will be saved to: gru_training_20250914-102728.log
2025-09-14 10:27:28,022 - __main__ - INFO - Configuration loaded successfully
2025-09-14 10:27:28,022 - __main__ - INFO - Model configuration:
GRU Model Configuration Summary:
================================
Architecture:
  - Input: 128 time steps × 14 features
  - 4x Bidirectional GRU layers (32 units each)
  - Output: 5 classes
  - Estimated parameters: ~86,853

Training Setup:
  - Learning rate: 0.001
  - Batch size: 16
  - Max epochs: 15
  - Dropout: 0.3
  - Validation split: 0.2
  - Early stopping patience: 2

Monitoring:
  - Metrics: accuracy, precision, recall, f1_score
  - Model save path: /fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Project_3/GRU/models/saved_Models/gru_experiment2.keras
2025-09-14 10:27:28,022 - __main__ - INFO - Loading data from /fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/dataset/combined_dataset_short_balanced_encoded_normalised.csv
2025-09-14 10:27:29,160 - __main__ - INFO - Data loaded successfully: (500000, 15)
2025-09-14 10:27:29,160 - __main__ - INFO - Features: ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13']
2025-09-14 10:27:29,160 - __main__ - INFO - Target: label_stage_encoded
2025-09-14 10:27:29,160 - __main__ - INFO - Preparing preprocessed data for GRU training...
2025-09-14 10:27:29,200 - __main__ - INFO - Feature matrix shape: (500000, 14)
2025-09-14 10:27:29,200 - __main__ - INFO - Target vector shape: (500000,)
2025-09-14 10:27:31,692 - __main__ - INFO - Created 499873 sequences of length 128
2025-09-14 10:27:31,692 - __main__ - INFO - Sequence shape: (499873, 128, 14)
2025-09-14 10:27:31,692 - __main__ - INFO - Target shape: (499873,)
2025-09-14 10:27:31,692 - __main__ - INFO - Preprocessed data preparation completed successfully
2025-09-14 10:27:31,692 - __main__ - INFO - Final sequence shape: (499873, 128, 14)
2025-09-14 10:27:31,692 - __main__ - INFO - Final target shape: (499873,)
2025-09-14 10:27:31,695 - __main__ - INFO - Class distribution: [100000  99873 100000 100000 100000]
2025-09-14 10:27:31,698 - __main__ - INFO - Random seeds set to 42 for reproducibility
2025-09-14 10:27:31,783 - __main__ - INFO - No GPUs detected - using CPU only
2025-09-14 10:27:31,801 - __main__ - INFO - TensorFlow configured for CPU usage. Test tensor device: /job:localhost/replica:0/task:0/device:CPU:0
2025-09-14 10:27:31,801 - __main__ - INFO - Starting GRU model training...
2025-09-14 10:27:33,245 - __main__ - INFO - Training samples: 399898
2025-09-14 10:27:33,245 - __main__ - INFO - Validation samples: 99975
2025-09-14 10:27:33,548 - tensorflow - INFO - F1Score metric will be calculated manually during evaluation
2025-09-14 10:27:33,551 - __main__ - INFO - Model built successfully
2025-09-14 10:27:33,558 - __main__ - INFO - Model: "GRU_Model"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ bidirectional_gru_1 (Bidirectional)  │ (None, 128, 64)             │           9,216 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_1 (Dropout)                  │ (None, 128, 64)             │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ bidirectional_gru_2 (Bidirectional)  │ (None, 128, 64)             │          18,816 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_2 (Dropout)                  │ (None, 128, 64)             │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ bidirectional_gru_3 (Bidirectional)  │ (None, 128, 64)             │          18,816 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_3 (Dropout)                  │ (None, 128, 64)             │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ bidirectional_gru_4 (Bidirectional)  │ (None, 64)                  │          18,816 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dropout_4 (Dropout)                  │ (None, 64)                  │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ output_layer (Dense)                 │ (None, 5)                   │             325 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 65,989 (257.77 KB)
 Trainable params: 65,989 (257.77 KB)
 Non-trainable params: 0 (0.00 B)

2025-09-14 10:27:33,558 - __main__ - INFO - Beginning training process...
2025-09-14 10:27:48,825 - __main__ - ERROR - Training pipeline failed: Graph execution error:

Detected at node LogicalAnd_1 defined at (most recent call last):
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 902, in <module>

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 882, in main

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 728, in train

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 85, in train_step

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/trainers/trainer.py", line 490, in compute_metrics

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/trainers/compile_utils.py", line 334, in update_state

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/trainers/compile_utils.py", line 21, in update_state

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/metrics/confusion_metrics.py", line 378, in update_state

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/metrics/metrics_utils.py", line 595, in update_confusion_matrix_variables

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/metrics/metrics_utils.py", line 568, in weighted_assign_add

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/ops/numpy.py", line 4011, in logical_and

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/numpy.py", line 1737, in logical_and

Incompatible shapes: [1,80] vs. [1,16]
	 [[{{node LogicalAnd_1}}]] [Op:__inference_multi_step_on_iterator_16316]
2025-09-14 10:27:48,825 - __main__ - ERROR - Full traceback:
Traceback (most recent call last):
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 882, in main
    model, history = trainer.train(X, y)
                     ~~~~~~~~~~~~~^^^^^^
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 728, in train
    self.history = self.model.fit(
                   ~~~~~~~~~~~~~~^
        X_train, y_train,
        ^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        shuffle=True
        ^^^^^^^^^^^^
    )
    ^
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    except TypeError as e:
    ...<5 lines>...
      raise e
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node LogicalAnd_1 defined at (most recent call last):
  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 902, in <module>

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 882, in main

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/Research_Internship_Under_Dr_Rakesh_Matam/Project_3/GRU/scripts/train.py", line 728, in train

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 85, in train_step

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/trainers/trainer.py", line 490, in compute_metrics

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/trainers/compile_utils.py", line 334, in update_state

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/trainers/compile_utils.py", line 21, in update_state

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/metrics/confusion_metrics.py", line 378, in update_state

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/metrics/metrics_utils.py", line 595, in update_confusion_matrix_variables

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/metrics/metrics_utils.py", line 568, in weighted_assign_add

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/ops/numpy.py", line 4011, in logical_and

  File "/fab3/btech/2022/siddhant.gond22b@iiitg.ac.in/miniconda3/lib/python3.13/site-packages/keras/src/backend/tensorflow/numpy.py", line 1737, in logical_and

Incompatible shapes: [1,80] vs. [1,16]
	 [[{{node LogicalAnd_1}}]] [Op:__inference_multi_step_on_iterator_16316]
